{% extends "layout.html" %}

{% block title %}Edit Citation{% endblock %}

{% block body %}

{% if citation %}
<h1>Edit Citation</h1>
<form method="POST" action="{{ url_for('edit_citation', citation_id=citation.id) }}">
  <label>Citation key:
    <input type="text" name="citation_key" value="{{ citation.citation_key }}" required>
  </label>
  <br>
  {% for f, val in citation.fields|dictsort %}
  <label>{{ f.replace("_", " ").capitalize() }}
    <input type="text" name="{{ f }}" value="{{ val }}">
  </label>
  <br>
  {% endfor %}
  <br>
  {% if categories %}
  <label>Assign existing category:
    <select name="category">
      <option value="" selected>Select a category</option>
      {% for c in categories or [] %}
      <option value="{{ c.name }}">{{ c.name }}</option>
      {% endfor %}
    </select>
  </label>
  {% endif %}
  <label>Assign category:
    <input type="text" name="category_new" placeholder="New Category">
  </label>
  <br>

  {% if tags %}
  <label>Assign existing tags:
    <select name="tags" multiple>
      {% for t in tags or [] %}
      <option value="{{ t.name }}">{{ t.name }}</option>
      {% endfor %}
    </select>
  </label>
  <br>
  {% endif %}
  <label>Assign tags (comma-separated):
    <input type="text" name="tags_new" placeholder="tag1, tag2">
  </label>

  <button type="submit">Save Changes</button>
</form>
{% else %}
<p>Citation not found.</p>
{% endif %}


<form action="/citations" method="get" style="display:inline; margin-top:10px;">
  <button type="submit">Back</button>
</form>

{% endblock %}
